!function(a){"use strict";function b(a,b,d,g){var h=e.width();a.parent().append(b);var i=a.siblings(".mpc-coords"),j=i.find(".mpc-coords__overlay"),k=i.find(".mpc-coords__point"),l=a.val().split("||");i.css("max-width",h),g&&(i.attr("data-id",d),f.append(i.clone())),2==l.length&&(l[0]=isNaN(parseFloat(l[0]))?50:parseFloat(l[0]),l[1]=isNaN(parseFloat(l[1]))?50:parseFloat(l[1]),k.css({left:l[0]+"%",top:l[1]+"%"})),c(i,j,k,a)}function c(a,b,c,e){var f,g=!1;b.on("mousedown",function(a){g=!0,a.preventDefault()}).on("mouseup",function(){g=!1}).on("mouseleave",function(){f=setTimeout(function(){b.trigger("mouseup")},500)}).on("mouseenter",function(){clearTimeout(f)}).on("mousemove",function(b){g&&d(a,c,e,b)}).on("click",function(b){d(a,c,e,b)}).on("dragstart",function(a){a.preventDefault()})}function d(a,b,c,d){var e="undefined"!=typeof d.offsetX?d.offsetX:d.originalEvent.layerX,f="undefined"!=typeof d.offsetY?d.offsetY:d.originalEvent.layerY,g={x:(e/a.width()*100).toFixed(3),y:(f/a.height()*100).toFixed(3)};b.css({left:g.x+"%",top:g.y+"%"}),c.val(g.x+"||"+g.y)}var e=a("#vc_ui-panel-edit-element"),f=a('<div id="mpc_hotspot_images_cache" class="mpc-hotspot-images-cache" />');f.appendTo("body"),e.on("mpc.render",function(){if("mpc_hotspot"==e.attr("data-vc-shortcode")){var c=a(".wpb_vc_param_value.position"),d=a('<button class="mpc-vc-button button mpc-default">'+_mpc_lang.mpc_hotspot.set_position+"</button>"),g="";if(g=vc.shortcodes.findWhere({id:vc.active_panel.model.attributes.parent_id}).attributes.params.background_image,"undefined"==typeof g&&(g=""),""==g)return void c.parent().append('<p class="mpc-error">'+_mpc_lang.mpc_hotspot.no_background+"</p>");c.parent().append(d),d.one("click",function(){d.remove(),f.find('.mpc-coords[data-id="'+g+'"]').length?b(c,f.find('.mpc-coords[data-id="'+g+'"]').clone(),g,!1):a.post(ajaxurl,{action:"mpc_hotspot_get_image",image_id:g},function(a){b(c,a,g,!0)})})}})}(jQuery);